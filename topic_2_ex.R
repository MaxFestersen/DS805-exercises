# Exercise set 2 ----------------------------------------------------------

# > 2.25 -------------------------------------------------------------------
x.cov <- matrix(c(25, -2, 4,
           -2, 4, 1,
           4, 1, 9),
           nrow = 3,
           ncol = 3
           )
# >> a --------------------------------------------------------------------
# >>> Determine fancy p

# >>> Determine V^½

# >> b ---------------------------------------------------------------------
# Multiply matrices and check relation (V^½)*p*(V^½) = E


# 2.30  -------------------------------------------------------------------

# You are given the random vector X' = [x_1, x_2, x_3, x_4] 
# with mean vector µ'x = [4,3,2,1]

var_cov_var <- matrix(c(3, 0, 2, 2, 0, 1, 1, 0, 2, 1, 9, -2, 2, 0, -2, 4), nrow = 4)

# Partition X as [x_1, x_2] = [X¹], [x_3, x_4] = [x²]

# Let

A <- c(1,2)
B <- matrix(c(1, 2, -2, -1), nrow = 2)

# and consider the linear combinations AX¹ and BX². Find:


# (a) E(X^1) --------------------------------------------------------------


# E(AX^1) -----------------------------------------------------------------


# Cov(X^1) ----------------------------------------------------------------



# Cov(AX^1) ---------------------------------------------------------------


# E(X^2) ------------------------------------------------------------------


# E(BX^2) -----------------------------------------------------------------


# Cov(X^2) ----------------------------------------------------------------


# Cov(BX^2) ---------------------------------------------------------------


# Cov(X^1, X^2) -----------------------------------------------------------


# Cov(AX^1, BX^2) ---------------------------------------------------------


# > 2.27 ------------------------------------------------------------------


# > 2.41 ------------------------------------------------------------------


# > 3.7 -------------------------------------------------------------------
# Sketch the solid elipsoids (x-x.hat)'*(S^-1)*(x-x.hat) <= 1

S.1 <- matrix(c(5,4, # Accutal name is S
                4,5),
              nrow = 2, ncol = 2)
S.2 <- matrix(c(5,-4, # Accutal name is S
                -4,5),
              nrow = 2, ncol = 2)
S.3 <- matrix(c(3,0, # Accutal name is S
                0,3),
              nrow = 2, ncol = 2)

# > 3.8 -------------------------------------------------------------------


# > 3.11 ------------------------------------------------------------------


# > 3.14 ------------------------------------------------------------------
X <- matrix(c(9,5,1, # From ex 3.1
            1,3,2),
            nrow = 3, ncol = 2)
n <- 3
p <- 2
# X1
# X2
# c'X = [-1,2]*[X1,X2] = X1 + 2X2
# b'X = [2,3]*[X1,X2]' = 2X1 + 3X2

# >> a --------------------------------------------------------------------
# >>>for c'X and b'X: Evaluate from first principle:
# Note: calculate c'X and b'X, then calculate the other stuff.
# >>>> The sample means

# >>>> The variances

# >>>> The covariances

# >> b --------------------------------------------------------------------
# >>>for c'X and b'X: calculate using 3-36:
# Note: se side 141 (pdf side 162)
# >>>> The sample means

# >>>> The variances

# >>>> The covariances

# >>> Compare results from a and b

# > 3.18 ------------------------------------------------------------------





